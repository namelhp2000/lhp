@{
    ViewBag.Title = "Detail";
    var Detail ="Detail?displaymodel=1&"+Html.Raw(ViewBag.query);
    var DisDetail ="Detail?displaymodel=0&"+Html.Raw(ViewBag.query);
   // &stepid="+Html.Raw(ViewBag.stepid)+"&groupid="+Html.Raw(ViewBag.groupid)+
}
@using RoadFlow.Utility
<div class="toolbar" style="margin-top:0; border-top:0;">
    <a href="javascript:void(0);" onclick="window.location='@Html.Raw(Detail)';return false;"><i class="fa fa-image"></i><label>图形方式</label></a>
    <span class="toolbarsplit">&nbsp;</span>
    <a href="javascript:void(0);" onclick="window.location='@Html.Raw(DisDetail)';return false;"><i class="fa fa-reorder"></i><label>列表方式</label></a>
    <span class="toolbarsplit">&nbsp;</span>
    <a href="javascript:void(0);" onclick="new RoadUI.Window().close();"><i class="fa fa-times"></i><label>关闭窗口</label></a>
</div>

@{ if (ViewBag.displaymodel == "0")
    {
        <table id="listtable"></table>
        <script type="text/javascript">
        var rows = @Html.Raw(ViewBag.json);
        var ismobile = "1" === "@ViewBag.ismobile";
        $(function ()
        {
            $("#listtable").jqGrid({
                datatype: "local",
                colNames: ['步骤名称', '发送人', '接收时间', '处理人', '完成时间', '状态', '意见', '备注'],
                colModel: [
                    { name: 'StepName', index: 'StepName' },
                    { name: 'SenderName', index: 'SenderName', align: "left" },
                    { name: 'SenderTime', index: 'SenderTime', width:200, align: "left" },
                    { name: 'ReceiveName', index: 'ReceiveName', align: "left" },
                    { name: 'CompletedTime1', index: 'CompletedTime1', width:200, align: "left" },
                    { name: 'StatusTitle', index: 'StatusTitle', align: "left" },
                    { name: 'Comment', index: 'Comment', align: "left" },
                    { name: 'Note', index: 'Note', align: "left" }
                ],
                rownumbers: false,//显示序号列
                height: ismobile ? 320 :400,
                rowNum: rows.length,
                width: ismobile ? 800 : $(window).width(),
                data: rows
            });
            //鼠标移动背景颜色变化
            $("#listtable tr").mouseenter(function () {
                $(this).css("background", "lightblue");
            });
            $("#listtable tr").mouseleave(function () {
                $(this).css("background", "white");
            });
        });
        function showSubFlow(taskid)
        {
            new RoadUI.Window().open({
                title: '查看子流程处理过程',
                url: 'DetailSubFlow?taskid=' + taskid + '', width: 1000, height: 500, openerid: '@ViewBag.tabid'
            });
        }
        </script>
    }
    else
    {
        <div style="padding:8px 5px 0 10px;">
            <div style="float:left; height:12px; width:12px; background:#2b9425; margin-top:2px; border-radius:4px; margin-left:6px;"></div>
            <div style="float:left;font-size:12px; margin-left:3px;">已完成步骤</div>
            <div style="float:left; height:12px; width:12px; background:#fc7803; margin-top:2px; border-radius:4px; margin-left:12px;"></div>
            <div style="float:left;font-size:12px;margin-left:3px;">当前步骤</div>
        </div>
        <div id="flowdiv" style="margin:0; padding:0; overflow:auto; clear:both;"></div>
        <script type="text/javascript">
            var isshowDesign = false;
            var taskJSON = @Html.Raw(ViewBag.json1);
        </script>
        <script src="/RoadFlowResources/scripts/flowDesigner/draw-min.js" type="text/javascript"></script>
        <script src="/RoadFlowResources/scripts/flowDesigner/workflow-show.js" type="text/javascript"></script>
        <script type="text/javascript">
    $(function () {
        if ('@StringExtensions.IsNullOrWhiteSpace(ViewBag.stepid)'=="True") {
            openFlow1('@ViewBag.flowid');
        }
        else {
             openFlow1('@ViewBag.flowid', '@ViewBag.stepid', '@ViewBag.groupid');
        }
                $(window.document.body).niceScroll({ cursorcolor: "#ACACAC", autohidemode: "leave" });
            });
        </script>


    }
}




